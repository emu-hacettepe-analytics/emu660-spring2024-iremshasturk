---
title: "The impact of renewable energy production on supply-demand balance and carbon emissions in Turkey"
format:
  html:
    code-fold: true
    code-summary: "Show the code"
    code-copy: true
---

The share of renewable energy production in the total energy supplied and demanded in Turkey changes every year. In this project, first the supply-demand relationship and the effect of renewable energy on this will be examined, and then the effect of renewable energy on carbon emissions will be examined.

![](assets/images/sustainable-energy.webp)

# 1. Project Overview and Scope

In today's world, energy is perceived as the cornerstone of economic development, and it needs to be sustainably provided while considering its environmental impacts. In this context, renewable energy sources have the potential to minimize environmental effects by reducing dependency on fossil fuels. For countries like Turkey, with rapidly increasing energy demands and a strategic geographical location, the impact of renewable energy production on supply-demand balance and its effect on carbon emissions are of vital importance.

This project aims to examine the current status of renewable energy production in Turkey, evaluate its effects on supply-demand balance, and analyze its impact on carbon emissions. In this regard, the project plans to examine and analyze data such as the amount of energy derived from renewable energy sources in Turkey, trends in energy consumption increase, carbon emissions, and the status of renewable energy investments.

# 2. Data

This project will utilize various data sources to assess the impact of renewable energy production on the supply-demand balance and carbon emissions in Turkey. In this regard, the following types of data and sources will be used:

1.  **Renewable Energy Production Data**: Official statistics and reports regarding the amount and distribution of energy generated from solar, wind, hydroelectric, and other renewable energy sources in Turkey will be examined.

2.  **Trends in Energy Consumption**: Data published by national energy agencies and relevant organizations will be utilized to determine trends in energy consumption in Turkey.

3.  **Carbon Emissions Data**: Data on Turkey's carbon emissions will be collected from sources such as greenhouse gas inventories and international reports, and will be analyzed.

4.  **Status of Renewable Energy Investments**: The status and trends of investments in the renewable energy sector in Turkey will be examined through financial reports of energy companies and sectoral analyses.

## 2.1 Data Source

Renewable Energy Production and Trends in Energy Consumption data is obtained from <a href="https://seffaflik.epias.com.tr/home">EPİAŞ Transparency Platform</a> .

Greenhouse Gas Emissions Statistics from 2015 to 2021 is obtained from <a href="https://data.tuik.gov.tr/Bulten/Index?p=Greenhouse-Gas-Emissions-Statistics-1990-2021-49672&dil=2">Turkish Statistical Institute</a> .

Monthly Global Greenhouse Gas Emissions Statistics is obtained from <a href="https://edgar.jrc.ec.europa.eu/dataset_ghg80">EDGAR - Emissions Database for Global Atmospheric Research</a> .

## 2.2 General Information About Data

<a href="https://seffaflik.epias.com.tr/electricity/electricity-generation/ex-post-generation/real-time-generation">**Real-Time Generation**</a> : The display of hourly generation values of electricity generation plants on a resource basis.

For example, 2015 real-time hourly energy production data is as follows:

```{r}
#install.packages("readxl")
library(readxl)

library(dplyr)
library(magrittr)
prod_2015 <- read_excel("C:\\Users\\irems\\Documents\\GitHub\\emu660-spring2024-iremshasturk\\assets\\Real-Time_Generation-2015.xlsx")
head(prod_2015)

```

<a href="https://data.tuik.gov.tr/Bulten/Index?p=Greenhouse-Gas-Emissions-Statistics-1990-2021-49672&dil=2">The Greenhouse Gas Emissions</a>:

Greenhouse Gas Emissions Statistics by sector, 2015-2021 is as follows:

```{r}

ghg_emissions <- read_excel("C:\\Users\\irems\\Documents\\GitHub\\emu660-spring2024-iremshasturk\\assets\\ghg.xlsx")
head(ghg_emissions)
```

<a href="https://edgar.jrc.ec.europa.eu/dataset_ghg80">CO2 emission time series</a> :

Monthly emission time series (1970-2022) by sector and country are provided in an overview table (.xls) for the three main greenhouse gases

For example, CO2 emission data for the first 6 months of 2015 is as follows:

```{r}
co2_emissions <- read_excel("C:\\Users\\irems\\Documents\\GitHub\\emu660-spring2024-iremshasturk\\assets\\co2_emissions.xlsx")
head(co2_emissions)
```

## 2.3 Reason of Choice

The reasons for choosing this topic include the strategic importance of Turkey's energy supply-demand balance and environmental sustainability, the potential of renewable energy sources to reduce environmental impacts, the necessity to reduce carbon emissions in line with international commitments (ex: Paris Agreement), and the technological advancement and economic opportunities offered by the renewable energy sector. Therefore, the project aims to assess the impact of renewable energy production on Turkey's supply-demand balance and carbon emissions, contributing to the shaping of energy policies.

## 2.4 Preprocessing

Due to data complexity, hourly data converted to monthly data. Thus, it has become easier to examine. Data obtained for 2015 after preprocessing:

```{r}
prod_monthly_2015 <- read_excel("C:\\Users\\irems\\Documents\\GitHub\\emu660-spring2024-iremshasturk\\assets\\Real-Time_Generation-monthly_2015.xlsx")
prod_monthly_2016 <- read_excel("C:\\Users\\irems\\Documents\\GitHub\\emu660-spring2024-iremshasturk\\assets\\Real-Time_Generation-monthly_2016.xlsx")
prod_monthly_2017 <- read_excel("C:\\Users\\irems\\Documents\\GitHub\\emu660-spring2024-iremshasturk\\assets\\Real-Time_Generation-monthly_2017.xlsx")
prod_monthly_2018 <- read_excel("C:\\Users\\irems\\Documents\\GitHub\\emu660-spring2024-iremshasturk\\assets\\Real-Time_Generation-monthly_2018.xlsx")
prod_monthly_2019 <- read_excel("C:\\Users\\irems\\Documents\\GitHub\\emu660-spring2024-iremshasturk\\assets\\Real-Time_Generation-monthly_2019.xlsx")
prod_monthly_2020 <- read_excel("C:\\Users\\irems\\Documents\\GitHub\\emu660-spring2024-iremshasturk\\assets\\Real-Time_Generation-monthly_2020.xlsx")
prod_monthly_2021 <- read_excel("C:\\Users\\irems\\Documents\\GitHub\\emu660-spring2024-iremshasturk\\assets\\Real-Time_Generation-monthly_2021.xlsx")
head(prod_monthly_2015)
head(prod_monthly_2020)

chooseCRANmirror(ind=1)
#install.packages("ggplot2") 
library(ggplot2)

combined_data_2015_2020 <- rbind(prod_monthly_2015, prod_monthly_2020)
combined_data_2015_2020$Year <- factor(rep(c("2015", "2020"), each = nrow(prod_monthly_2015)))

months_ordered <- c("January", "February", "March", "April", "May", "June", 
                    "July", "August", "September", "October", "November", "December")

combined_data_2015_2020$Date <- factor(combined_data_2015_2020$Date, levels = months_ordered)

combined_data_from2015to2020 <- rbind(prod_monthly_2015, prod_monthly_2016,prod_monthly_2017, prod_monthly_2018,prod_monthly_2019, prod_monthly_2020)
combined_data_from2015to2020$Year <- factor(rep(c("2015", "2016","2017", "2018","2019", "2020"), each = nrow(prod_monthly_2015)))


combined_data_from2015to2020 <- combined_data_from2015to2020 %>% rename(month = Date)


combined_data_from2015to2020$month <- factor(combined_data_from2015to2020$month, levels = months_ordered)

renewable_data_from2015to2020 <- combined_data_from2015to2020 %>% select("month", "Year", "Wind", "Solar", "Geothermal", "River", "Dammed Hydro", "Biomass","Total")

renewable_data_from2015to2020 <- renewable_data_from2015to2020 %>%
  mutate(Renewable_Total = rowSums(select(., c("Wind", "Solar", "Geothermal", "River", "Dammed Hydro", "Biomass"))))



annual_data_from2015to2020 <- combined_data_from2015to2020 %>%
  group_by(Year) %>%
  summarise(across(starts_with("Total"), sum, na.rm = TRUE),
            across(c("Natural Gas", "Dammed Hydro", "Lignite", "River", 
                     "Import Coal", "Wind", "Solar", "Fuel Oil", 
                     "Geothermal", "Asphaltite Coal", "Black Coal", 
                     "Biomass", "Naphta", "LNG", "Import-Export", 
                     "Waste Heat"), sum, na.rm = TRUE))


```

```{r}
ggplot(combined_data_2015_2020) +
  geom_line(aes(x = Date, y = Total, color = Year, group=Year)) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))+
    labs(
    x = "Month",
    y = "Total Energy Production",
    
  )  
```

# 3. Analysis

First of all, the change in renewable energy production in Turkey between 2015 and 2021 will be examined. In the next stage, the effects of renewable energy production on the supply-demand balance will be analyzed. Finally, its impact on carbon emissions will be analyzed.

## 3.1 Exploratory Data Analysis

### 3.1.1. Change in renewable energy production

In the graph above, it can be seen that the energy production in 2020 is mostly higher than in 2015.

```{r}

ggplot(combined_data_from2015to2020) +
  geom_line(linewidth = 1,aes(x = month, y = Total, color = Year, group=Year))+
    labs(
    x = "Month",
    y = "Total Energy Production",
    
  ) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) 

```

The graph above shows that no solar energy was produced in 2015.

```{r}
ggplot(combined_data_from2015to2020) +
  geom_line(linewidth = 1,aes(x = month, y = Solar, color = Year, group=Year))+
  labs(
    x = "Month",
    y = "Solar Energy Production",
    
  ) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1),
   plot.title = element_text(hjust = 0.5)     ) 

```

The graph above shows renewable energy production.

```{r}
ggplot(renewable_data_from2015to2020) +
  geom_line(linewidth = 1,aes(x = month, y = Renewable_Total, color = Year, group=Year))+
  labs(
    x = "Month",
    y = "Renewable Energy Production",
    
  ) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1),
   plot.title = element_text(hjust = 0.5)     ) 

```

## 3.2 Time Series Analysis

The change in co2 emissions over the years is as follows:

```{r}
co2_emissions$month <- factor(co2_emissions$month, levels = months_ordered)

ggplot(co2_emissions, aes(x=month, y=emissions, color=Year, group=Year)) + geom_line(linewidth = 1)+
  scale_color_brewer(palette = "Set3") +
labs(
    title = "Monthly CO2 Emissions Over Years",
    x = "Month",
    y = "CO2 Emissions",
    color = "Year"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5)
  )+
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

```

It is seen that emissions increase every year. The changes during the year are similar in most years.

**Relation analysis:**

```{r}
#install.packages("dplyr")
#install.packages("magrittr")
library(dplyr)
library(magrittr)



merged_data <- merge(co2_emissions, renewable_data_from2015to2020, by = c("Year", "month"))


merged_data$month <- factor(merged_data$month, levels = months_ordered)

#ggplot(merged_data, aes(x = YearMonth)) + 
#  geom_line(aes(y = emissions/1000, color = "CO2 Emission (x1000)", group=1)) + 
#  geom_line(aes(y = Renewable_Total/1000000, color = "Total Renewable Energy (x1M)", group=1)) + 
#  scale_y_continuous(
#    name = "CO2 Emission (x1000)",
#    sec.axis = sec_axis(~ . , name = "Renewable Energy (x1M)")
#  ) +
#  labs(x = "Year-Month", color = "Legend") +
#  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
#  ggtitle("CO2 Emissions and Renewable Energy Production Over Time")
```

**Correlation analysis:**

```{r}


co2_emissions_to2020 <- co2_emissions %>%
  filter(Year >= 2015 & Year <= 2020) 

co2_energy <- merge(co2_emissions_to2020, renewable_data_from2015to2020, by=c("Year", "month"))
cor(co2_energy$emissions, co2_energy$Renewable_Total)
```

The correlation coefficient is very close to almost zero, indicating a very weak and almost no relationship between co2 emissions and renewable energy generation. In this case, an increase or decrease in one variable does not show any relationship with an increase or decrease in the other variable.

```{r}
ggplot(co2_energy, aes(x = emissions, y = Renewable_Total)) +
  geom_point() +
  
  labs(title = "Scatter Plot of CO2 Emissions vs. Total Renewable Energy",
       x = "CO2 Emissions",
       y = "Total Renewable Energy") +
  theme_minimal()
```

**Annual analysis:**

```{r}
annual_co2_energy <- co2_energy %>%
  group_by(Year) %>%
  summarise(
    Annual_CO2_Emission = sum(emissions),
    Annual_Total_Renewable_Energy = sum(Renewable_Total)
  )


ggplot(annual_co2_energy, aes(x = factor(Year), y = Annual_Total_Renewable_Energy)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "Annual Total Renewable Energy Production", x = "Year", y = "Total Renewable Energy") +
  theme_minimal()

ggplot(annual_co2_energy, aes(x = Year)) + 
  geom_line(aes(y = Annual_CO2_Emission/1000, color = "CO2 Emission (x1000)", group=1)) + 
  geom_line(aes(y = Annual_Total_Renewable_Energy/1000000, color = "Total Renewable Energy (x1M)", group=1)) + 
  scale_y_continuous(
    name = "CO2 Emission (x1000)",
    sec.axis = sec_axis(~ . , name = "Renewable Energy (x1M)")
  ) +
  labs(x = "Year", color = "Legend") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  ggtitle("CO2 Emissions and Renewable Energy Production Over Time")
```

**Annual correlation analysis:**

```{r}

cor(annual_co2_energy$Annual_CO2_Emission, annual_co2_energy$Annual_Total_Renewable_Energy)
```

\
The positive correlation coefficient obtained in the annual analysis indicates a **stronger relationship** between the two variables. However, since the coefficient is still not very close to 1, it can be said that the relationship is strong but **not perfectly linear**.

Therefore, the different correlation coefficients obtained by changing the analysis periods show how the relationship between the two variables can change over time. While monthly analysis reflects shorter-term fluctuations and changes, annual analysis evaluates trends and relationships over a longer time horizon.

```{r}
# Korelasyonun anlamlılığını test etme
yearly_cor_test <- cor.test(annual_co2_energy$Annual_CO2_Emission, annual_co2_energy$Annual_Total_Renewable_Energy)
print(yearly_cor_test)
```

### **Summary**

-   **Correlation:** The correlation coefficient is 0.3053169, indicating a weak relationship.

-   **Significance:** The p-value is 0.5563, which shows that the relationship is not statistically significant.

```{r}
ggplot(annual_co2_energy, aes(x = Annual_CO2_Emission, y = Annual_Total_Renewable_Energy)) +
  geom_point() +
  geom_smooth(method = "lm", col = "red") +
  labs(title = "Scatter Plot of Annual CO2 Emissions vs. Annual Total Renewable Energy",
       x = "Annual CO2 Emissions",
       y = "Annual Total Renewable Energy") +
  theme_minimal()
```

**Sector based analysis:**

```{r}
#install.packages("reshape2")
#install.packages("tidyverse")  
library(reshape2)
ghg_melt <- melt(ghg_emissions, id.vars="Sector", variable.name="Year", value.name="GHG_Emission")
ggplot(ghg_melt, aes(x=Year, y=GHG_Emission, color=Sector)) + geom_point()
```

It seems that **energy** largely contributes to emissions.

```{r}
ghg_emissions <- as.data.frame(t(ghg_emissions))
colnames(ghg_emissions) <- ghg_emissions[1,]
ghg_emissions <- ghg_emissions[-1,]
library(tibble)
ghg_emissions <- ghg_emissions %>% rownames_to_column(var = "Year")

annual_co2_energy_ghg <- merge(annual_co2_energy, ghg_emissions, by=c("Year"))
# Korelasyonun anlamlılığını test etme
annual_co2_energy_ghg$"Total Emissions" <- as.numeric(annual_co2_energy_ghg$"Total Emissions")
yearly_cor_test <- cor.test(annual_co2_energy_ghg$"Total Emissions", annual_co2_energy$Annual_Total_Renewable_Energy)
print(yearly_cor_test)
```

## 3.3 Model Fitting

```{r}
annual_per <- renewable_data_from2015to2020 %>%
  group_by(Year) %>%
  summarise(
    Annual_ren_per = sum(Renewable_Total)/sum(Total),
    Annual_ren = sum(Renewable_Total),
    Annual_total=sum(Total)
  )
ggplot(annual_per) +
  geom_line(aes(x = Year, y = Annual_ren_per,  group=1)) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) 
```

## 3.4 Results

xxxxxx

# 4. Results and Key Takeaways

xxxxxx
